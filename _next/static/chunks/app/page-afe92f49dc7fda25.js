(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1931],{53562:function(e,t,s){Promise.resolve().then(s.bind(s,40480))},40480:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return T}});var a=s(57437),i=s(28207),l=s(99376),n=s(25779),r=s(48810),c=s(53517),o=s(29660),d=s(25187),m=s(51945);let u=e=>{let{edition:t,isSchoolInscriptionEnabled:s}=e;return(0,l.useRouter)(),(0,a.jsxs)("div",{className:"px-4 justify-center items-center flex h-full flex-col space-y-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold",children:["\xc9dition ",t.year," - ",t.name]}),t.inscription_enabled?s?null:(0,a.jsx)("h3",{className:"text-lg font-medium text-orange-600",children:"Les inscriptions ne sont pas encore ouvertes pour votre \xe9cole."}):(0,a.jsx)("h3",{className:"text-lg font-medium text-orange-600",children:"Les inscriptions ne sont pas encore ouvertes pour cette \xe9dition."}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground text-center",children:["L'\xe9dition d\xe9butera le"," ",new Date(t.start_date).toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Veuillez patienter."})]})};var x=s(12381);let h=e=>{let{edition:t,meCompetition:s,hasPaid:i}=e,n=(0,l.useRouter)();return(0,a.jsxs)("div",{className:"px-4 justify-center items-center flex h-full flex-col space-y-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold",children:["\xc9dition ",t.year," - ",t.name]}),(0,a.jsxs)("div",{className:"text-center space-y-3",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-orange-600",children:"Inscription incompl\xe8te"}),!(null==s?void 0:s.validated)&&!i&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Votre inscription n'est pas encore valid\xe9e et le paiement n'a pas \xe9t\xe9 effectu\xe9."}),!(null==s?void 0:s.validated)&&!!i&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Votre paiement a \xe9t\xe9 re\xe7u mais votre inscription n'est pas encore valid\xe9e."}),(null==s?void 0:s.validated)&&!i&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Votre inscription est valid\xe9e mais le paiement n'a pas encore \xe9t\xe9 effectu\xe9."}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Veuillez finaliser votre inscription pour acc\xe9der \xe0 toutes les fonctionnalit\xe9s."}),(0,a.jsx)(x.z,{onClick:()=>n.push("/register"),className:"mt-4",children:"Finaliser mon inscription"})]})]})},p=e=>{let{meCompetition:t}=e;return(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"Statut(s)"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[t.is_athlete&&(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:"Athl\xe8te"}),t.is_volunteer&&(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"B\xe9n\xe9vole"}),t.is_pompom&&(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-pink-100 text-pink-800 rounded-full",children:"Pom-pom"}),t.is_fanfare&&(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-purple-100 text-purple-800 rounded-full",children:"Fanfare"}),t.is_cameraman&&(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 rounded-full",children:"Cam\xe9raman"}),!t.is_athlete&&!t.is_volunteer&&!t.is_pompom&&!t.is_fanfare&&!t.is_cameraman&&(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 rounded-full",children:"Supporter"})]})]})};var f=s(89307),j=s(67740),v=s(99914),g=s(70399),N=s(27875),b=s(76715),y=s(79820),_=s(95805),w=s(79205);let k=(0,w.Z)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),A=(0,w.Z)("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);var z=s(31047),P=s(49474),S=s(91723),M=s(2265);let Z=e=>{let{edition:t,meCompetition:s}=e,{meParticipant:i}=(0,j.a)(),{me:r}=(0,n.a)(),c=(0,l.useRouter)(),{sportMatches:o}=(0,v.k)({sportId:null==i?void 0:i.sport_id}),{teams:d}=(0,g.y)({sportId:null==i?void 0:i.sport_id,schoolId:null==i?void 0:i.school_id}),{sports:m}=(0,N.V)(),{schools:u}=(0,b.A)(),h=null==i?void 0:i.team_id,w=null==d?void 0:d.find(e=>e.id===h),Z=null==m?void 0:m.find(e=>e.id===(null==i?void 0:i.sport_id)),D=null==u?void 0:u.find(e=>e.id===(null==i?void 0:i.school_id)),{upcomingMatches:C,pastMatches:T,totalMatches:L,victories:V}=(0,M.useMemo)(()=>{if(!o||!h)return{upcomingMatches:[],pastMatches:[],totalMatches:0,victories:0};let e=new Date().getTime();return o.reduce((t,s)=>{if(s.team1_id!==h&&s.team2_id!==h||(t.totalMatches++,!s.date))return t;let a=new Date(s.date).getTime();return a>e?t.upcomingMatches.push({...s,_matchTime:a}):(t.pastMatches.push({...s,_matchTime:a}),s.winner_id===h&&t.victories++),t},{upcomingMatches:[],pastMatches:[],totalMatches:0,victories:0})},[o,h]),I=C.sort((e,t)=>e._matchTime-t._matchTime)[0],E=s.is_athlete;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold",children:["\xc9dition ",t.year," - ",t.name]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Du ",new Date(t.start_date).toLocaleDateString("fr-FR")," au"," ",new Date(t.end_date).toLocaleDateString("fr-FR")]})]}),(0,a.jsx)(p,{meCompetition:s}),E&&w&&(0,a.jsxs)(y.Zb,{children:[(0,a.jsx)(y.Ol,{children:(0,a.jsxs)(y.ll,{className:"text-lg flex items-center gap-2",children:[(0,a.jsx)(_.Z,{className:"h-5 w-5 text-primary"}),"Mon \xc9quipe"]})}),(0,a.jsx)(y.aY,{children:(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"bg-primary/10 p-2 rounded-full",children:(0,a.jsx)(_.Z,{className:"h-4 w-4 text-primary"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"\xc9quipe"}),(0,a.jsx)("p",{className:"font-semibold",children:w.name})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"bg-blue-100 p-2 rounded-full",children:(0,a.jsx)(k,{className:"h-4 w-4 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Sport"}),(0,a.jsx)("p",{className:"font-semibold",children:(null==Z?void 0:Z.name)||(null==i?void 0:i.sport_id)})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"bg-green-100 p-2 rounded-full",children:(0,a.jsx)(A,{className:"h-4 w-4 text-green-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"\xc9cole"}),(0,a.jsx)("p",{className:"font-semibold",children:(null==D?void 0:D.name)||(null==i?void 0:i.school_id)})]})]})]})})]}),E&&(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-4",children:[(0,a.jsxs)(y.Zb,{children:[(0,a.jsxs)(y.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(y.ll,{className:"text-sm font-medium",children:"Total Matchs"}),(0,a.jsx)(z.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(y.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:L})})]}),(0,a.jsxs)(y.Zb,{children:[(0,a.jsxs)(y.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(y.ll,{className:"text-sm font-medium",children:"\xc0 venir"}),(0,a.jsx)(z.Z,{className:"h-4 w-4 text-blue-500"})]}),(0,a.jsx)(y.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:C.length})})]}),(0,a.jsxs)(y.Zb,{children:[(0,a.jsxs)(y.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(y.ll,{className:"text-sm font-medium",children:"Jou\xe9s"}),(0,a.jsx)(P.Z,{className:"h-4 w-4 text-green-500"})]}),(0,a.jsx)(y.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600",children:T.length})})]}),(0,a.jsxs)(y.Zb,{children:[(0,a.jsxs)(y.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(y.ll,{className:"text-sm font-medium",children:"Victoires"}),(0,a.jsx)(P.Z,{className:"h-4 w-4 text-yellow-500"})]}),(0,a.jsx)(y.aY,{children:(0,a.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:V})})]})]}),E&&I&&(0,a.jsxs)(y.Zb,{children:[(0,a.jsxs)(y.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[(0,a.jsxs)(y.ll,{className:"text-lg flex items-center gap-2",children:[(0,a.jsx)(S.Z,{className:"h-5 w-5"}),"Prochain Match"]}),(0,a.jsx)(x.z,{variant:"outline",size:"sm",onClick:()=>c.push("/matches"),children:"Voir tous les matchs"})]}),(0,a.jsx)(y.aY,{children:(0,a.jsx)(f.m,{match:I,userTeamId:h,urgency:I.date?(e=>{let t=new Date,s=(new Date(e).getTime()-t.getTime())/6e4;return s<=15?"urgent":s<=60?"soon":"normal"})(I.date):"normal",timeUntil:I.date?(e=>{let t=new Date,s=Math.round((new Date(e).getTime()-t.getTime())/6e4);if(s<0)return"Pass\xe9";if(s<60)return"".concat(s,"min");let a=Math.floor(s/60),i=s%60;return 0===i?"".concat(a,"h"):"".concat(a,"h").concat(i.toString().padStart(2,"0"))})(I.date):"N/A"})})]}),E&&!I&&(0,a.jsxs)(y.Zb,{children:[(0,a.jsx)(y.Ol,{children:(0,a.jsxs)(y.ll,{className:"text-lg flex items-center gap-2",children:[(0,a.jsx)(z.Z,{className:"h-5 w-5 text-muted-foreground"}),"Prochain Match"]})}),(0,a.jsxs)(y.aY,{className:"flex flex-col items-center justify-center py-6",children:[(0,a.jsx)(z.Z,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Aucun match programm\xe9"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground text-center mb-4",children:"Aucun match n'est programm\xe9 pour le moment."}),(0,a.jsx)(x.z,{variant:"outline",onClick:()=>c.push("/matches"),children:"Voir l'historique"})]})]})]})};var D=s(55403);let C=e=>{let{edition:t}=e,s=(0,l.useRouter)();return(0,a.jsxs)("div",{className:"px-4 justify-center items-center flex h-full flex-col space-y-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold",children:["\xc9dition ",t.year," - ",t.name]}),(0,a.jsxs)("div",{className:"text-center space-y-3",children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-orange-600",children:"Inscription non commenc\xe9e"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Vous n'avez pas commenc\xe9 votre inscription."}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Si vous souhaitez participer, veuillez vous inscrire."}),(0,a.jsx)(x.z,{onClick:()=>s.push("/register"),className:"mt-4",children:"Commencer mon inscription"})]})]})};var T=()=>{var e;let{isTokenQueried:t,token:s}=(0,i.a)(),{me:x,isAdmin:p}=(0,n.a)(),{meCompetition:f,isLoading:j}=(0,d.s)(),{hasPaid:v}=(0,m.T)();(0,l.useSearchParams)();let g=(0,l.useRouter)(),{edition:N}=(0,o.n)(),{schools:y}=(0,b.A)(),{sportSchools:_}=(0,D.m)(),w=null!=N&&!!N.start_date&&new Date>=new Date(N.start_date),k=null!=N&&!!N.end_date&&new Date>=new Date(N.end_date),A=(null==f?void 0:f.validated)&&v,z=(null==x?void 0:x.school_id)||(null==x?void 0:null===(e=x.school)||void 0===e?void 0:e.id),P=null==_?void 0:_.find(e=>e.school_id===z),S=null==P?void 0:P.inscription_enabled;return t&&null===s&&g.replace("/login"),(0,a.jsxs)(c.Hn,{children:[(0,a.jsx)(r.S,{}),(0,a.jsxs)(c.kV,{children:[(0,a.jsx)("header",{className:"flex h-16 shrink-0 items-center gap-2",children:(0,a.jsx)("div",{className:"flex items-center gap-2 px-4",children:(0,a.jsx)(c.vP,{className:"-ml-1"})})}),(0,a.jsxs)("div",{className:"flex flex-col relative overflow-auto h-full m-6",children:[!N&&(0,a.jsx)("span",{className:"text-sm text-muted-foreground px-4 justify-center items-center flex h-full",children:"Veuillez patienter, l'\xe9dition n'est pas encore pr\xeate."}),N&&(!N.inscription_enabled||!S)&&!(w||k)&&(0,a.jsx)(u,{edition:{year:N.year,name:N.name,start_date:N.start_date,inscription_enabled:N.inscription_enabled||!1},isSchoolInscriptionEnabled:!!S}),N&&N.inscription_enabled&&S&&A&&f&&(0,a.jsx)(Z,{edition:N,meCompetition:f}),N&&N.inscription_enabled&&S&&f&&!A&&(0,a.jsx)(h,{edition:N,meCompetition:f,hasPaid:v}),N&&N.inscription_enabled&&S&&!f&&!j&&x&&!(w||k)&&S&&(0,a.jsx)(C,{edition:N})]})]})]})}},25187:function(e,t,s){"use strict";s.d(t,{s:function(){return n}});var a=s(41494),i=s(28207),l=s(18752);let n=()=>{let{token:e,isTokenExpired:t}=(0,i.a)(),{data:s,isLoading:n,refetch:r}=(0,a.gvp)({headers:{Authorization:"Bearer ".concat(e)}},{enabled:!t(),retry:0}),{mutate:c,isPending:o}=(0,a.yRA)(),d=async(t,s)=>c({headers:{Authorization:"Bearer ".concat(e)},body:t},{onSettled:(e,t)=>{t.stack.body||t.stack.detail?(console.log(t),(0,l.Am)({title:"Erreur lors de l'ajout de l'utilisateur",description:t.stack.body||t.stack.detail,variant:"destructive"})):(r(),s(),(0,l.Am)({title:"Utilisateur ajout\xe9",description:"L'utilisateur a \xe9t\xe9 ajout\xe9 avec succ\xe8s."}))}}),{mutate:m,isPending:u}=(0,a.Wq6)(),x=async(t,s)=>m({headers:{Authorization:"Bearer ".concat(e)},body:t},{onSettled:(e,t)=>{t.stack.body||t.stack.detail?(console.log(t),(0,l.Am)({title:"Erreur lors de la modification de l'utilisateur",description:t.stack.body||t.stack.detail,variant:"destructive"})):(r(),s(),(0,l.Am)({title:"Utilisateur modifi\xe9",description:"L'utilisateur a \xe9t\xe9 modifi\xe9 avec succ\xe8s."}))}}),{mutate:h,isPending:p}=(0,a.bGf)(),{mutate:f,isPending:j}=(0,a.nE0)();return{meCompetition:s,isLoading:n,refetchMeCompetition:r,createCompetitionUser:d,updateCompetitionUser:x,isCreateLoading:o,validateParticipants:(t,s)=>h({headers:{Authorization:"Bearer ".concat(e)},pathParams:{userId:t}},{onSettled:(e,t)=>{t.stack.body||t.stack.detail?(console.log(t),(0,l.Am)({title:"Erreur lors de la mise \xe0 jour",description:t.stack.body||t.stack.detail,variant:"destructive"})):(r(),s(),(0,l.Am)({title:"Participant mis \xe0 jour",description:"Le participant a \xe9t\xe9 mis \xe0 jour avec succ\xe8s."}))}}),isValidateLoading:p,isInvalidateLoading:j,invalidateParticipants:(t,s)=>f({headers:{Authorization:"Bearer ".concat(e)},pathParams:{userId:t}},{onSettled:(e,t)=>{t.stack.body||t.stack.detail?(console.log(t),(0,l.Am)({title:"Erreur lors de la mise \xe0 jour",description:t.stack.body||t.stack.detail,variant:"destructive"})):(r(),s(),(0,l.Am)({title:"Participant mis \xe0 jour",description:"Le participant a \xe9t\xe9 mis \xe0 jour avec succ\xe8s."}))}})}}},55403:function(e,t,s){"use strict";s.d(t,{m:function(){return r}});var a=s(41494),i=s(25779),l=s(28207),n=s(18752);let r=()=>{let{token:e,isTokenExpired:t}=(0,l.a)(),{isAdmin:s}=(0,i.a)(),{data:r,refetch:c,error:o}=(0,a.Xs5)({headers:{Authorization:"Bearer ".concat(e)}},{enabled:s()&&!t(),retry:0,queryHash:"getSportSchools"}),{mutate:d,isPending:m}=(0,a.dlg)(),{mutate:u,isPending:x}=(0,a.NIq)(),{mutate:h,isPending:p}=(0,a.TI1)();return{sportSchools:r,createCompetitionSchool:(t,s)=>d({headers:{Authorization:"Bearer ".concat(e)},body:t},{onSettled:(e,t)=>{t.stack.body||t.stack.detail?(console.log(t),(0,n.Am)({title:"Erreur lors de la fusion des \xe9quipes",description:t.stack.body||t.stack.detail,variant:"destructive"})):(c(),s(),(0,n.Am)({title:"\xc9cole ajout\xe9e",description:"L'\xe9cole a \xe9t\xe9 ajout\xe9e avec succ\xe8s."}))}}),updateCompetitionSchool:(t,s,a)=>u({headers:{Authorization:"Bearer ".concat(e)},pathParams:{schoolId:t},body:s},{onSettled:(e,t)=>{t.stack.body||t.stack.detail?(console.log(t),(0,n.Am)({title:"Erreur lors de la mise \xe0 jour",description:t.stack.body||t.stack.detail,variant:"destructive"})):(c(),a(),(0,n.Am)({title:"\xc9cole mise \xe0 jour",description:"L'\xe9cole a \xe9t\xe9 mise \xe0 jour avec succ\xe8s."}))}}),deleteCompetitionSchool:(t,s)=>h({headers:{Authorization:"Bearer ".concat(e)},pathParams:{schoolId:t}},{onSettled:(e,t)=>{t.stack.body||t.stack.detail?(console.log(t),(0,n.Am)({title:"Erreur lors de la suppression",description:t.stack.body||t.stack.detail,variant:"destructive"})):(c(),s(),(0,n.Am)({title:"\xc9cole supprim\xe9e",description:"L'\xe9cole a \xe9t\xe9 supprim\xe9e avec succ\xe8s."}))}}),error:o,isLoading:m,isUpdateLoading:x,isDeleteLoading:p,refetchSchools:c}}},51945:function(e,t,s){"use strict";s.d(t,{T:function(){return l}});var a=s(41494),i=s(28207);let l=()=>{let{token:e,isTokenExpired:t,userId:s}=(0,i.a)(),{data:l,isLoading:n,error:r,refetch:c}=(0,a.MYc)({headers:{Authorization:"Bearer ".concat(e)},pathParams:{userId:s}},{enabled:!!s&&!t(),retry:0,queryHash:"getUserPayments"}),o=l&&l.length>0;return{payments:l,hasPaid:o,isLoading:n,error:r,refetchPayments:c}}},95098:function(e,t,s){"use strict";s.d(t,{C2:function(){return n},TX:function(){return r},fC:function(){return c}});var a=s(2265),i=s(66840),l=s(57437),n=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),r=a.forwardRef((e,t)=>(0,l.jsx)(i.WV.span,{...e,ref:t,style:{...n,...e.style}}));r.displayName="VisuallyHidden";var c=r}},function(e){e.O(0,[1414,9522,411,278,8068,9859,5184,1312,4278,8175,4430,3448,5515,2971,2117,1744],function(){return e(e.s=53562)}),_N_E=e.O()}]);