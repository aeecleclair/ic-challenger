(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[658],{88381:function(e,t,a){Promise.resolve().then(a.bind(a,7851))},7851:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return K}});var s=a(57437),l=a(99376),r=a(5454),i=a(2265),n=a(27875),c=a(13533),d=a(25779),o=a(55403),u=a(40785),m=a(69174),p=a(17168),x=a(49474),h=a(79820),f=a(56096),g=a(49322),v=a(95805),j=a(41671);let N=e=>{let{totalParticipants:t,totalValidated:a,totalTeams:l,sportQuotas:r,schoolName:i}=e,n=r.reduce((e,t)=>e+((null==t?void 0:t.participant_quota)||0),0),c=r.reduce((e,t)=>e+((null==t?void 0:t.team_quota)||0),0),d=n>0&&t>n,o=c>0&&l>c;return(0,s.jsxs)(h.Zb,{className:"mb-6",children:[(0,s.jsx)(h.Ol,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(h.ll,{className:"flex items-center gap-2",children:[(0,s.jsx)(f.Z,{className:"h-5 w-5"}),"Aper\xe7u global - ",i]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[d&&(0,s.jsxs)(m.C,{variant:"destructive",className:"text-xs",children:[(0,s.jsx)(g.Z,{className:"h-3 w-3 mr-1"}),"Quota participants d\xe9pass\xe9"]}),o&&(0,s.jsxs)(m.C,{variant:"destructive",className:"text-xs",children:[(0,s.jsx)(g.Z,{className:"h-3 w-3 mr-1"}),"Quota \xe9quipes d\xe9pass\xe9"]})]})]})}),(0,s.jsxs)(h.aY,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(v.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-muted-foreground",children:"Total participants"})]}),(0,s.jsxs)("div",{className:"text-2xl font-bold ".concat(d?"text-destructive":""),children:[t,(0,s.jsxs)("span",{className:"text-lg text-muted-foreground ml-1",children:["/ ",n]})]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(x.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-muted-foreground",children:"Total \xe9quipes"})]}),(0,s.jsxs)("div",{className:"text-2xl font-bold ".concat(o?"text-destructive":""),children:[l,(0,s.jsxs)("span",{className:"text-lg text-muted-foreground ml-1",children:["/ ",c]})]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(j.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-muted-foreground",children:"Participants valid\xe9s"})]}),(0,s.jsx)("div",{className:"text-2xl font-bold text-green-600",children:a}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:[t>0?Math.round(a/t*100):0,"% valid\xe9s"]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(g.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-muted-foreground",children:"En attente"})]}),(0,s.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:t-a}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Participants non valid\xe9s"})]})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm mb-2",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Progression de validation"}),(0,s.jsxs)("span",{className:"font-medium",children:[a," / ",t]})]}),(0,s.jsx)("div",{className:"w-full bg-secondary rounded-full h-3",children:(0,s.jsx)("div",{className:"bg-primary rounded-full h-3 transition-all",style:{width:"".concat(t>0?a/t*100:0,"%")}})})]})]})]})};var y=a(31593),b=a(71594),w=a(24525),C=a(12381),_=a(33804),k=a(28842),S=a(67782),V=a(32060),A=a(71488),P=a(84834),q=a(20653),z=a(40279),I=a(68473),F=a(29964);function Z(e){var t,a;let{table:l,typeOptions:r}=e,i=l.getState().columnFilters.length>0;return(0,s.jsx)("div",{className:"flex flex-wrap items-center justify-between gap-2 py-4",children:(0,s.jsxs)("div",{className:"flex flex-1 items-center gap-2 flex-wrap",children:[(0,s.jsx)(z.I,{placeholder:"Rechercher par nom ou email...",value:null!==(a=null===(t=l.getColumn("searchField"))||void 0===t?void 0:t.getFilterValue())&&void 0!==a?a:"",onChange:e=>{var t;return null===(t=l.getColumn("searchField"))||void 0===t?void 0:t.setFilterValue(e.target.value)},className:"h-8 max-w-sm"}),l.getColumn("participantType")&&(0,s.jsx)(I.P,{column:l.getColumn("participantType"),title:"Type",options:r}),l.getColumn("license")&&(0,s.jsx)(F.Y,{column:l.getColumn("license"),title:"Licence"}),l.getColumn("isSubstitute")&&(0,s.jsx)(F.Y,{column:l.getColumn("isSubstitute"),title:"Rempla\xe7ant"}),l.getColumn("isValidated")&&(0,s.jsx)(F.Y,{column:l.getColumn("isValidated"),title:"Valid\xe9"}),i&&(0,s.jsxs)(C.z,{variant:"ghost",onClick:()=>l.resetColumnFilters(),className:"h-8 px-2 lg:px-3",children:["Supprimer les filtres",(0,s.jsx)(q.Pxu,{className:"ml-2 h-4 w-4"})]})]})})}function T(e){let{data:t,onValidateParticipant:a,isLoading:l}=e,[r,n]=i.useState([]),[c,d]=i.useState([]),[o,u]=i.useState({}),p=[{id:"searchField",accessorFn:e=>"".concat(e.fullName," ").concat(e.email).toLowerCase(),filterFn:(e,t,a)=>{let s=a.toLowerCase(),l=e.getValue("fullName").toLowerCase(),r=e.getValue("email").toLowerCase();return l.includes(s)||r.includes(s)}},{accessorKey:"fullName",header:e=>{let{column:t}=e;return(0,s.jsxs)(C.z,{variant:"ghost",onClick:()=>t.toggleSorting("asc"===t.getIsSorted()),className:"flex items-center",children:["Nom",(0,s.jsx)(k.Z,{className:"ml-2 h-4 w-4"})]})},cell:e=>{let{row:t}=e,a=t.getValue("fullName"),l=t.original.isCaptain;return(0,s.jsxs)("div",{className:"font-medium text-center flex items-center justify-center gap-2",children:[l&&(0,s.jsx)(A.pn,{children:(0,s.jsxs)(A.u,{children:[(0,s.jsx)(A.aJ,{asChild:!0,children:(0,s.jsx)("span",{children:(0,s.jsx)(v.Z,{className:"h-4 w-4"})})}),(0,s.jsx)(A._v,{children:(0,s.jsx)("p",{children:"Capitaine d'\xe9quipe"})})]})}),a]})}},{accessorKey:"email",header:e=>{let{column:t}=e;return(0,s.jsxs)(C.z,{variant:"ghost",onClick:()=>t.toggleSorting("asc"===t.getIsSorted()),className:"flex items-center",children:["Email",(0,s.jsx)(k.Z,{className:"ml-2 h-4 w-4"})]})},cell:e=>{let{row:t}=e;return(0,s.jsx)("div",{className:"text-center",children:t.getValue("email")})}},{accessorKey:"license",header:e=>{let{column:t}=e;return(0,s.jsxs)(C.z,{variant:"ghost",onClick:()=>t.toggleSorting("asc"===t.getIsSorted()),className:"flex items-center",children:["Licence",(0,s.jsx)(k.Z,{className:"ml-2 h-4 w-4"})]})},cell:e=>{let{row:t}=e;return(0,s.jsx)("div",{className:"text-center",children:t.getValue("license")||"Non renseign\xe9e"})},filterFn:(e,t,a)=>{if(void 0===a)return!0;let s=e.getValue(t);return!0!==a||!!s}},{accessorKey:"teamName",header:e=>{let{column:t}=e;return(0,s.jsxs)(C.z,{variant:"ghost",onClick:()=>t.toggleSorting("asc"===t.getIsSorted()),className:"flex items-center",children:["\xc9quipe",(0,s.jsx)(k.Z,{className:"ml-2 h-4 w-4"})]})},cell:e=>{let{row:t}=e,a=t.getValue("teamName");return a&&"-"!==a?(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(m.C,{variant:"secondary",className:"bg-indigo-100 text-indigo-800 hover:bg-indigo-200",children:a})}):(0,s.jsx)("div",{className:"text-center text-muted-foreground",children:"-"})},filterFn:(e,t,a)=>{if(void 0===a)return!0;let s=e.getValue(t);return!0!==a||!!s}},{accessorKey:"participantType",header:e=>{let{column:t}=e;return(0,s.jsxs)(C.z,{variant:"ghost",onClick:()=>t.toggleSorting("asc"===t.getIsSorted()),className:"flex items-center",children:["Type",(0,s.jsx)(k.Z,{className:"ml-2 h-4 w-4"})]})},cell:e=>{let{row:t}=e,a=t.getValue("participantType").split(", ");return(0,s.jsx)("div",{className:"flex flex-wrap gap-1 justify-center",children:a.map((e,t)=>{let a="";switch(e){case"Athl\xe8te":a="bg-blue-100 text-blue-800 hover:bg-blue-200";break;case"Pompom":a="bg-pink-100 text-pink-800 hover:bg-pink-200";break;case"Fanfare":a="bg-yellow-100 text-yellow-800 hover:bg-yellow-200";break;case"Cameraman":a="bg-purple-100 text-purple-800 hover:bg-purple-200";break;case"B\xe9n\xe9vole":a="bg-green-100 text-green-800 hover:bg-green-200";break;default:a=""}return(0,s.jsx)(m.C,{variant:"secondary",className:a,children:e},t)})})},filterFn:(e,t,a)=>!a||0===a.length||e.getValue(t).split(", ").some(e=>a.includes(e))},{accessorKey:"isSubstitute",header:e=>{let{column:t}=e;return(0,s.jsxs)(C.z,{variant:"ghost",onClick:()=>t.toggleSorting("asc"===t.getIsSorted()),className:"flex items-center",children:["Rempla\xe7ant",(0,s.jsx)(k.Z,{className:"ml-2 h-4 w-4"})]})},cell:e=>{let{row:t}=e;return(0,s.jsx)("div",{className:"flex justify-center",children:t.getValue("isSubstitute")?(0,s.jsx)(m.C,{variant:"outline",children:"Oui"}):(0,s.jsx)(m.C,{variant:"secondary",children:"Non"})})},filterFn:(e,t,a)=>{if(void 0===a)return!0;let s=e.getValue(t);return!0!==a||!0===s}},{accessorKey:"isValidated",header:e=>{let{column:t}=e;return(0,s.jsxs)(C.z,{variant:"ghost",onClick:()=>t.toggleSorting("asc"===t.getIsSorted()),className:"flex items-center",children:["Valid\xe9",(0,s.jsx)(k.Z,{className:"ml-2 h-4 w-4"})]})},cell:e=>{let{row:t}=e;return(0,s.jsx)("div",{className:"flex justify-center",children:t.getValue("isValidated")?(0,s.jsx)(m.C,{variant:"secondary",className:"bg-green-100 text-green-800 hover:bg-green-200",children:"Oui"}):(0,s.jsx)(m.C,{variant:"destructive",children:"Non"})})},filterFn:(e,t,a)=>{if(void 0===a)return!0;let s=e.getValue(t);return!0!==a||!0===s}},{id:"actions",header:()=>(0,s.jsx)("div",{className:"text-center",children:"Actions"}),cell:e=>{let{row:t}=e,r=t.original;if(r.isValidated){let e=r.hasPaid;return void 0===e?(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(m.C,{variant:"outline",className:"bg-gray-100 text-gray-600",children:"Paiement: Inconnu"})}):(0,s.jsx)("div",{className:"flex justify-center",children:e?(0,s.jsx)(m.C,{variant:"secondary",className:"bg-green-100 text-green-800 hover:bg-green-200",children:"Pay\xe9"}):(0,s.jsx)(m.C,{variant:"destructive",children:"En attente de paiement"})})}return(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsxs)(V.h_,{children:[(0,s.jsx)(V.$F,{asChild:!0,children:(0,s.jsxs)(C.z,{variant:"ghost",className:"h-8 w-8 p-0",disabled:l,children:[(0,s.jsx)("span",{className:"sr-only",children:"Ouvrir le menu"}),(0,s.jsx)(S.Z,{className:"h-4 w-4"})]})}),(0,s.jsx)(V.AW,{align:"end",children:(0,s.jsxs)(V.Xi,{onClick:()=>a(r.userId,r.sportId),disabled:l,children:[(0,s.jsx)(j.Z,{className:"mr-2 h-4 w-4"}),"Valider"]})})]})})}}];i.useEffect(()=>{u(e=>({...e,searchField:!1}))},[]);let x=(0,b.b7)({data:t,columns:p,state:{sorting:r,columnFilters:c,columnVisibility:o},onSortingChange:n,onColumnFiltersChange:d,onColumnVisibilityChange:u,getCoreRowModel:(0,w.sC)(),getFilteredRowModel:(0,w.vL)(),getPaginationRowModel:(0,w.G_)(),getSortedRowModel:(0,w.tj)()}),h=i.useMemo(()=>{let e=new Set;return t.forEach(t=>{t.participantType.split(", ").forEach(t=>e.add(t))}),Array.from(e).map(e=>({label:e,value:e}))},[t]);return(0,s.jsxs)("div",{children:[(0,s.jsx)(Z,{table:x,typeOptions:h}),(0,s.jsx)("div",{className:"rounded-md border",children:(0,s.jsxs)(_.iA,{children:[(0,s.jsx)(_.xD,{children:x.getHeaderGroups().map(e=>(0,s.jsx)(_.SC,{children:e.headers.map(e=>"searchField"===e.id?null:(0,s.jsx)(_.ss,{className:(e.id,"text-center"),children:e.isPlaceholder?null:(0,b.ie)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,s.jsx)(_.RM,{children:x.getRowModel().rows.length>0?x.getRowModel().rows.sort((e,t)=>e.getValue("fullName").localeCompare(t.getValue("fullName"))).map(e=>(0,s.jsx)(_.SC,{children:e.getVisibleCells().map(e=>"searchField"===e.column.id?null:(0,s.jsx)(_.pj,{className:(e.column.id,"text-center"),children:(0,b.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,s.jsx)(_.SC,{children:(0,s.jsx)(_.pj,{colSpan:p.length-1,className:"text-center py-4 text-muted-foreground",children:"Aucun participant trouv\xe9 pour cette \xe9cole"})})})]})}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(P.k,{table:x,selectedLabel:"participant(s) s\xe9lectionn\xe9(s)",itemsPerPageLabel:"Participants par page",showSelectedCount:!1})})]})}var E=a(45362);let R=e=>{let{sportId:t,sportName:a,participants:l,quota:r,onValidateParticipant:n,isLoading:c,schoolId:d,schoolName:o}=e,{teams:u}=(0,E.E)({schoolId:d,sportId:t}),p=(0,i.useMemo)(()=>l.map(e=>{if(e.teamId&&u){let t=u.find(t=>t.id===e.teamId);return{...e,teamName:(null==t?void 0:t.name)||e.teamId,isCaptain:(null==t?void 0:t.captain_id)===e.userId}}return e}),[l,u]),f=p.length,N=p.filter(e=>e.isValidated).length,b=null==r?void 0:r.participant_quota,w=null==r?void 0:r.team_quota,C=new Set(p.map(e=>e.teamId).filter(Boolean)).size,_=!!b&&f>b,k=!!w&&C>w;return(0,s.jsxs)(h.Zb,{className:"h-full",children:[(0,s.jsx)(h.Ol,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(h.ll,{className:"flex items-center gap-2",children:[(0,s.jsx)(x.Z,{className:"h-5 w-5"}),a]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[_&&(0,s.jsxs)(m.C,{variant:"destructive",className:"text-xs",children:[(0,s.jsx)(g.Z,{className:"h-3 w-3 mr-1"}),"Quota participants d\xe9pass\xe9"]}),k&&(0,s.jsxs)(m.C,{variant:"destructive",className:"text-xs",children:[(0,s.jsx)(g.Z,{className:"h-3 w-3 mr-1"}),"Quota \xe9quipes d\xe9pass\xe9"]}),!_&&f===b&&b>0&&(0,s.jsxs)(m.C,{variant:"outline",className:"text-xs",children:[(0,s.jsx)(j.Z,{className:"h-3 w-3 mr-1"}),"Quota participants atteint"]}),!k&&C===w&&w>0&&(0,s.jsxs)(m.C,{variant:"outline",className:"text-xs",children:[(0,s.jsx)(j.Z,{className:"h-3 w-3 mr-1"}),"Quota \xe9quipes atteint"]})]})]})}),(0,s.jsxs)(h.aY,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(v.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-muted-foreground",children:"Participants"})]}),b&&(0,s.jsxs)("div",{className:"font-medium ".concat(_?"text-destructive":""),children:[f," / ",b]})]}),w>0&&(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(x.Z,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-muted-foreground",children:"\xc9quipes"})]}),(0,s.jsxs)("div",{className:"font-medium ".concat(k?"text-destructive":""),children:[C," / ",w]})]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Valid\xe9s"}),(0,s.jsxs)("span",{className:"font-medium",children:[N," / ",f]})]}),(0,s.jsx)("div",{className:"w-full bg-secondary rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-primary rounded-full h-2 transition-all",style:{width:"".concat(f>0?N/f*100:0,"%")}})})]}),(0,s.jsx)(y.Z,{}),(0,s.jsx)("div",{className:"overflow-y-auto",children:(0,s.jsx)(T,{data:p,schoolName:o,onValidateParticipant:n,isLoading:c})})]})]})};var Y=a(41494),L=a(28207),Q=a(25187),B=a(57665),M=a(3558),O=a(56229),K=()=>{var e;let t=(0,l.useRouter)(),{sportSchools:a}=(0,o.m)(),{sports:h}=(0,n.V)(),{me:f,isAdmin:g}=(0,d.a)(),{token:v,isTokenExpired:j}=(0,L.a)(),[y,b]=(0,i.useState)({}),[w,_]=(0,i.useState)(new Set),k=(0,l.useSearchParams)().get("school_id"),{schoolsGeneralQuota:S}=(0,B.T)({schoolId:k||void 0}),{schoolsProductQuota:V}=(0,M.a)({schoolId:k||void 0}),{products:P}=(0,O.r)(),q=null==f?void 0:f.school_id,z=g()||k===q,I=k||q,{schoolParticipants:F,error:Z}=(0,r.d)({schoolId:I||null}),{validateParticipants:T,isValidateLoading:E,refetchMeCompetition:K}=(0,Q.s)(),{sportsQuota:G}=(0,c.l)({sportId:void 0}),J=(0,i.useCallback)(async e=>{if(!(w.has(e)||!v||j()))try{let t=await (0,Y.LAz)({headers:{Authorization:"Bearer ".concat(v)},pathParams:{userId:e}}),a=t&&t.length>0;b(t=>({...t,[e]:a}))}catch(t){console.error("Error checking payment status for user",e,":",t),b(t=>({...t,[e]:void 0}))}finally{_(t=>new Set(t).add(e))}},[v,j,w]),U=e=>{T(e,()=>{})},H=(0,i.useMemo)(()=>(null==F?void 0:F.map(e=>{var t,a,s,l,r,i,n,c,d;return{userId:e.user_id,sportId:e.sport_id,sportName:(c=e.sport_id,(null==h?void 0:null===(d=h.find(e=>e.id===c))||void 0===d?void 0:d.name)||c),fullName:"".concat((null===(a=e.user)||void 0===a?void 0:null===(t=a.user)||void 0===t?void 0:t.firstname)||""," ").concat((null===(l=e.user)||void 0===l?void 0:null===(s=l.user)||void 0===s?void 0:s.name)||""),email:(null===(i=e.user)||void 0===i?void 0:null===(r=i.user)||void 0===r?void 0:r.email)||"",license:e.license||"",teamId:e.team_id,teamName:null,isCaptain:!1,isSubstitute:e.substitute||!1,isValidated:(null===(n=e.user)||void 0===n?void 0:n.validated)||!1,participantType:(e=>{var t,a,s,l;let r=[];return r.push("Athl\xe8te"),(null===(t=e.user)||void 0===t?void 0:t.is_pompom)&&r.push("Pompom"),(null===(a=e.user)||void 0===a?void 0:a.is_fanfare)&&r.push("Fanfare"),(null===(s=e.user)||void 0===s?void 0:s.is_cameraman)&&r.push("Cameraman"),(null===(l=e.user)||void 0===l?void 0:l.is_volunteer)&&r.push("B\xe9n\xe9vole"),r.join(", ")})(e),hasPaid:y[e.user_id]}}))||[],[F,h,y]);(0,i.useMemo)(()=>{let e={athlete_quota:0,cameraman_quota:0,pompom_quota:0,fanfare_quota:0,athlete_cameraman_quota:0,athlete_pompom_quota:0,athlete_fanfare_quota:0,non_athlete_cameraman_quota:0,non_athlete_pompom_quota:0,non_athlete_fanfare_quota:0};return H.forEach(t=>{t.isValidated&&(t.participantType.includes("Athl\xe8te")&&e.athlete_quota++,t.participantType.includes("Cameraman")&&e.cameraman_quota++,t.participantType.includes("Pompom")&&e.pompom_quota++,t.participantType.includes("Fanfare")&&e.fanfare_quota++,t.participantType.includes("Athl\xe8te")&&t.participantType.includes("Cameraman")&&e.athlete_cameraman_quota++,t.participantType.includes("Athl\xe8te")&&t.participantType.includes("Pompom")&&e.athlete_pompom_quota++,t.participantType.includes("Athl\xe8te")&&t.participantType.includes("Fanfare")&&e.athlete_fanfare_quota++,!t.participantType.includes("Athl\xe8te")&&t.participantType.includes("Cameraman")&&e.non_athlete_cameraman_quota++,!t.participantType.includes("Athl\xe8te")&&t.participantType.includes("Pompom")&&e.non_athlete_pompom_quota++,!t.participantType.includes("Athl\xe8te")&&t.participantType.includes("Fanfare")&&e.non_athlete_fanfare_quota++)}),e},[H]);let D=(0,i.useMemo)(()=>H.reduce((e,t)=>{let a=t.sportId;return e[a]||(e[a]={sportName:t.sportName,participants:[]}),e[a].participants.push(t),e},{}),[H]);if((0,i.useEffect)(()=>{H.length>0&&v&&!j()&&H.filter(e=>e.isValidated&&!w.has(e.userId)).slice(0,20).forEach((e,t)=>{setTimeout(()=>{J(e.userId)},100*t)})},[H,J,w,v,j]),!k&&q||k&&!z)return t.push("/admin/validation?school_id=".concat(q)),null;if(!I)return(0,s.jsx)("div",{className:"flex items-center justify-center h-full mt-10",children:(0,s.jsx)("p",{className:"text-gray-500",children:"Aucune \xe9cole associ\xe9e \xe0 votre compte"})});let X=null==a?void 0:a.find(e=>e.school_id===I),W=Object.entries(D),$=H.length,ee=H.filter(e=>e.isValidated).length,et=new Set(H.map(e=>e.teamId).filter(Boolean)).size;return(0,s.jsxs)("div",{className:"flex w-full flex-col p-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,s.jsxs)("span",{className:"text-2xl font-bold",children:["Validation des participants"," ",X?"- ".concat((0,u.E)(X.school.name)):""]})}),X&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"mb-6 flex items-center gap-4",children:[(0,s.jsx)("div",{className:"text-lg font-semibold mb-1",children:"Quotas g\xe9n\xe9raux"}),S&&(0,s.jsxs)(A.u,{children:[(0,s.jsx)(A.aJ,{asChild:!0,children:(0,s.jsx)(C.z,{variant:"ghost",size:"sm",className:"px-2 py-1 text-xs",children:"Quota g\xe9n\xe9ral"})}),(0,s.jsx)(A._v,{className:"max-w-xs",children:(0,s.jsx)("div",{className:"space-y-1",children:Object.entries(S).map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,s.jsx)("span",{className:"font-medium text-xs text-muted-foreground",children:t.replace(/_/g," ")}),(0,s.jsx)("span",{className:"text-xs",children:null!=a?a:0})]},t)})})})]}),V&&(0,s.jsxs)(A.u,{children:[(0,s.jsx)(A.aJ,{asChild:!0,children:(0,s.jsx)(C.z,{variant:"ghost",size:"sm",className:"px-2 py-1 text-xs",children:"Quota de produit"})}),(0,s.jsx)(A._v,{className:"max-w-xs",children:(0,s.jsx)("div",{className:"space-y-1",children:V.map(e=>{let t=null==P?void 0:P.find(t=>t.id===e.product_id);return(0,s.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,s.jsx)("span",{className:"font-medium text-xs text-muted-foreground",children:null==t?void 0:t.name}),(0,s.jsx)("span",{className:"text-xs",children:e.quota})]},e.product_id)})})})]})]}),(0,s.jsx)(N,{totalParticipants:$,totalValidated:ee,totalTeams:et,sportQuotas:G||[],schoolName:(0,u.E)(X.school.name)||"\xc9cole"})]}),W.length>0?(0,s.jsxs)(p.mQ,{defaultValue:null===(e=W[0])||void 0===e?void 0:e[0],className:"w-full",children:[(0,s.jsx)(p.dr,{className:"grid w-full grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 mb-6",children:W.map(e=>{let[t,{sportName:a,participants:l}]=e,r=null==G?void 0:G.find(e=>e.sport_id===t),i=r&&l.length>(r.participant_quota||0);return(0,s.jsx)(p.SP,{value:t,className:"relative",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(x.Z,{className:"h-4 w-4"}),a,(0,s.jsx)(m.C,{variant:i?"destructive":"secondary",className:"text-xs",children:l.length})]})},t)})}),W.map(e=>{let[t,{sportName:a,participants:l}]=e,r=null==G?void 0:G.find(e=>e.sport_id===t);return(0,s.jsx)(p.nU,{value:t,children:(0,s.jsx)(R,{sportId:t,sportName:a,participants:l,quota:r,onValidateParticipant:U,isLoading:E,schoolId:I||"",schoolName:X&&(0,u.E)(X.school.name)||"\xc9cole"})},t)})]}):(0,s.jsx)("div",{className:"flex items-center justify-center h-full mt-10",children:(0,s.jsx)("p",{className:"text-gray-500",children:"Aucun participant trouv\xe9 pour cette \xe9cole"})})]})}},68473:function(e,t,a){"use strict";a.d(t,{P:function(){return N}});var s=a(57437),l=a(2265),r=a(20653),i=a(94508),n=a(12749),c=a(12381),d=a(31593),o=a(69174),u=a(88965),m=a(73247);a(74291);let p=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(u.mY,{ref:t,className:(0,i.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",a),...l})});p.displayName=u.mY.displayName;let x=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,s.jsx)(m.Z,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,s.jsx)(u.mY.Input,{ref:t,className:(0,i.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",a),...l})]})});x.displayName=u.mY.Input.displayName;let h=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(u.mY.List,{ref:t,className:(0,i.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",a),...l})});h.displayName=u.mY.List.displayName;let f=l.forwardRef((e,t)=>(0,s.jsx)(u.mY.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));f.displayName=u.mY.Empty.displayName;let g=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(u.mY.Group,{ref:t,className:(0,i.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",a),...l})});g.displayName=u.mY.Group.displayName;let v=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(u.mY.Separator,{ref:t,className:(0,i.cn)("-mx-1 h-px bg-border",a),...l})});v.displayName=u.mY.Separator.displayName;let j=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(u.mY.Item,{ref:t,className:(0,i.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l})});function N(e){let{column:t,title:a,options:l}=e,u=null==t?void 0:t.getFacetedUniqueValues(),m=new Set(null==t?void 0:t.getFilterValue());return(0,s.jsxs)(n.J2,{children:[(0,s.jsx)(n.xo,{asChild:!0,children:(0,s.jsxs)(c.z,{variant:"outline",size:"sm",className:"h-8 border-dashed",children:[(0,s.jsx)(r.SPS,{className:"mr-2 h-4 w-4"}),a,(null==m?void 0:m.size)>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.Z,{orientation:"vertical",className:"mx-2 h-4"}),(0,s.jsx)(o.C,{variant:"secondary",className:"rounded-sm px-1 font-normal lg:hidden",children:m.size}),(0,s.jsx)("div",{className:"hidden space-x-1 lg:flex",children:m.size>2?(0,s.jsxs)(o.C,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:[m.size," s\xe9lectionn\xe9s"]}):l.filter(e=>m.has(e.value)).map(e=>(0,s.jsx)(o.C,{variant:"secondary",className:"rounded-sm px-1 font-normal",children:e.label},e.value))})]})]})}),(0,s.jsx)(n.yk,{className:"w-[200px] p-0",align:"start",children:(0,s.jsxs)(p,{children:[(0,s.jsx)(x,{placeholder:a}),(0,s.jsxs)(h,{children:[(0,s.jsx)(f,{children:"Aucun r\xe9sultat"}),(0,s.jsx)(g,{children:l.map(e=>{let a=m.has(e.value);return(0,s.jsxs)(j,{onSelect:()=>{a?m.delete(e.value):m.add(e.value);let s=Array.from(m);null==t||t.setFilterValue(s.length?s:void 0)},children:[(0,s.jsx)("div",{className:(0,i.cn)("mr-2 flex h-4 w-4 items-center justify-center rounded-sm border border-primary",a?"bg-primary text-primary-foreground":"opacity-50 [&_svg]:invisible"),children:(0,s.jsx)(r.nQG,{className:(0,i.cn)("h-4 w-4")})}),e.icon&&(0,s.jsx)(e.icon,{className:"mr-2 h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{children:e.label}),(null==u?void 0:u.get(e.value))&&(0,s.jsx)("span",{className:"ml-auto flex h-4 w-4 items-center justify-center font-mono text-xs",children:u.get(e.value)})]},e.value)})}),m.size>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v,{}),(0,s.jsx)(g,{children:(0,s.jsx)(j,{onSelect:()=>null==t?void 0:t.setFilterValue(void 0),className:"justify-center text-center",children:"Supprimer les filtres"})})]})]})]})})]})}j.displayName=u.mY.Item.displayName},29964:function(e,t,a){"use strict";a.d(t,{Y:function(){return n}});var s=a(57437),l=a(2265),r=a(68245),i=a(12381);function n(e){let{column:t,title:a}=e,n=!0===(null==t?void 0:t.getFilterValue()),c=()=>{null==t||t.setFilterValue(!n||void 0)};return l.useEffect(()=>{t&&!t.getFilterFn()&&(t.columnDef.filterFn=(e,t,a)=>{let s=e.getValue(t);return!0!==a||!0==!!s})},[t]),(0,s.jsxs)(i.z,{variant:"ghost",className:"h-8 border-dashed border",onClick:c,children:[(0,s.jsx)(r.X,{checked:n,className:"mr-2",onCheckedChange:c}),a]})}},68245:function(e,t,a){"use strict";a.d(t,{X:function(){return c}});var s=a(57437),l=a(2265),r=a(9270),i=a(30401),n=a(94508);let c=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.fC,{ref:t,className:(0,n.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...l,children:(0,s.jsx)(r.z$,{className:(0,n.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(i.Z,{className:"h-4 w-4"})})})});c.displayName=r.fC.displayName},12749:function(e,t,a){"use strict";a.d(t,{J2:function(){return n},xo:function(){return c},yk:function(){return d}});var s=a(57437),l=a(2265),r=a(27312),i=a(94508);let n=r.fC,c=r.xz,d=l.forwardRef((e,t)=>{let{className:a,align:l="center",sideOffset:n=4,...c}=e;return(0,s.jsx)(r.VY,{ref:t,align:l,sideOffset:n,className:(0,i.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...c})});d.displayName=r.VY.displayName},31593:function(e,t,a){"use strict";a.d(t,{Z:function(){return n}});var s=a(57437),l=a(2265),r=a(55156),i=a(94508);let n=l.forwardRef((e,t)=>{let{className:a,orientation:l="horizontal",decorative:n=!0,...c}=e;return(0,s.jsx)(r.f,{ref:t,decorative:n,orientation:l,className:(0,i.cn)("shrink-0 bg-border","horizontal"===l?"h-[1px] w-full":"h-full w-[1px]",a),...c})});n.displayName=r.f.displayName},17168:function(e,t,a){"use strict";a.d(t,{SP:function(){return d},dr:function(){return c},mQ:function(){return n},nU:function(){return o}});var s=a(57437),l=a(2265),r=a(20271),i=a(94508);let n=r.fC,c=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.aV,{ref:t,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...l})});c.displayName=r.aV.displayName;let d=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.xz,{ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...l})});d.displayName=r.xz.displayName;let o=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(r.VY,{ref:t,className:(0,i.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...l})});o.displayName=r.VY.displayName},25187:function(e,t,a){"use strict";a.d(t,{s:function(){return i}});var s=a(41494),l=a(28207),r=a(18752);let i=()=>{let{token:e,isTokenExpired:t}=(0,l.a)(),{data:a,isLoading:i,refetch:n}=(0,s.gvp)({headers:{Authorization:"Bearer ".concat(e)}},{enabled:!t(),retry:0}),{mutate:c,isPending:d}=(0,s.yRA)(),o=async(t,a)=>c({headers:{Authorization:"Bearer ".concat(e)},body:t},{onSettled:(e,t)=>{t.stack.body||t.stack.detail?(console.log(t),(0,r.Am)({title:"Erreur lors de l'ajout de l'utilisateur",description:t.stack.body||t.stack.detail,variant:"destructive"})):(n(),a(),(0,r.Am)({title:"Utilisateur ajout\xe9",description:"L'utilisateur a \xe9t\xe9 ajout\xe9 avec succ\xe8s."}))}}),{mutate:u,isPending:m}=(0,s.Wq6)(),p=async(t,a)=>u({headers:{Authorization:"Bearer ".concat(e)},body:t},{onSettled:(e,t)=>{t.stack.body||t.stack.detail?(console.log(t),(0,r.Am)({title:"Erreur lors de la modification de l'utilisateur",description:t.stack.body||t.stack.detail,variant:"destructive"})):(n(),a(),(0,r.Am)({title:"Utilisateur modifi\xe9",description:"L'utilisateur a \xe9t\xe9 modifi\xe9 avec succ\xe8s."}))}}),{mutate:x,isPending:h}=(0,s.bGf)(),{mutate:f,isPending:g}=(0,s.nE0)();return{meCompetition:a,isLoading:i,refetchMeCompetition:n,createCompetitionUser:o,updateCompetitionUser:p,isCreateLoading:d,validateParticipants:(t,a)=>x({headers:{Authorization:"Bearer ".concat(e)},pathParams:{userId:t}},{onSettled:(e,t)=>{t.stack.body||t.stack.detail?(console.log(t),(0,r.Am)({title:"Erreur lors de la mise \xe0 jour",description:t.stack.body||t.stack.detail,variant:"destructive"})):(n(),a(),(0,r.Am)({title:"Participant mis \xe0 jour",description:"Le participant a \xe9t\xe9 mis \xe0 jour avec succ\xe8s."}))}}),isValidateLoading:h,isInvalidateLoading:g,invalidateParticipants:(t,a)=>f({headers:{Authorization:"Bearer ".concat(e)},pathParams:{userId:t}},{onSettled:(e,t)=>{t.stack.body||t.stack.detail?(console.log(t),(0,r.Am)({title:"Erreur lors de la mise \xe0 jour",description:t.stack.body||t.stack.detail,variant:"destructive"})):(n(),a(),(0,r.Am)({title:"Participant mis \xe0 jour",description:"Le participant a \xe9t\xe9 mis \xe0 jour avec succ\xe8s."}))}})}}},5454:function(e,t,a){"use strict";a.d(t,{d:function(){return i}});var s=a(41494),l=a(25779),r=a(28207);let i=e=>{let{schoolId:t}=e,{token:a,isTokenExpired:i}=(0,r.a)(),{isAdmin:n}=(0,l.a)(),{data:c,refetch:d,error:o}=(0,s.H6Z)({headers:{Authorization:"Bearer ".concat(a)},pathParams:{schoolId:t}},{enabled:n()&&!i()&&!!t,retry:0,queryHash:"getSchoolParticipants"});return{schoolParticipants:c,error:o,refetchParticipantSchools:d}}},45362:function(e,t,a){"use strict";a.d(t,{E:function(){return i}});var s=a(41494),l=a(28207),r=a(18752);let i=e=>{let{schoolId:t,sportId:a}=e,{token:i,isTokenExpired:n}=(0,l.a)(),{data:c,isLoading:d,refetch:o}=(0,s.NNw)({headers:{Authorization:"Bearer ".concat(i)},pathParams:{schoolId:t,sportId:a}},{enabled:!n()&&!!t&&!!a,retry:0,queryHash:"getSchoolSportTeams"}),{mutate:u,isPending:m}=(0,s.UKJ)();return{teams:c,isLoading:d,refetchTeams:o,createSchoolSportTeam:(e,t)=>u({headers:{Authorization:"Bearer ".concat(i)},body:e},{onSettled:(e,a)=>{a.stack.body||a.stack.detail?(console.log(a),(0,r.Am)({title:"Erreur lors de l'ajout de l'\xe9quipe",description:a.stack.body||a.stack.detail,variant:"destructive"})):(o(),e&&t(e),(0,r.Am)({title:"\xc9quipe ajout\xe9e",description:"L'\xe9quipe a \xe9t\xe9 ajout\xe9e avec succ\xe8s."}))}}),isCreateLoading:m}}},13533:function(e,t,a){"use strict";a.d(t,{l:function(){return n}});var s=a(41494),l=a(25779),r=a(28207),i=a(18752);let n=e=>{let{sportId:t}=e,{token:a,isTokenExpired:n}=(0,r.a)(),{isAdmin:c}=(0,l.a)(),{data:d,refetch:o,error:u}=(0,s.NI8)({headers:{Authorization:"Bearer ".concat(a)},pathParams:{sportId:t}},{enabled:c()&&!n()&&!!t,retry:0,queryHash:"getSportsQuota"}),{mutate:m,isPending:p}=(0,s._Zy)(),{mutate:x,isPending:h}=(0,s.Rvs)(),{mutate:f,isPending:g}=(0,s.AVA)();return{sportsQuota:d,error:u,refetchSportsQuota:o,isCreateLoading:p,createQuota:(e,s,l)=>m({headers:{Authorization:"Bearer ".concat(a)},pathParams:{sportId:t,schoolId:e},body:s},{onSettled:(e,t)=>{t.stack.body||t.stack.detail?(console.log(t),(0,i.Am)({title:"Erreur lors de l'ajout du quota",description:t.stack.body||t.stack.detail,variant:"destructive"})):(o(),l(),(0,i.Am)({title:"Quota ajout\xe9",description:"Le quota a \xe9t\xe9 ajout\xe9 avec succ\xe8s."}))}}),isUpdateLoading:h,updateQuota:(e,s,l)=>x({headers:{Authorization:"Bearer ".concat(a)},pathParams:{sportId:t,schoolId:e},body:s},{onSettled:(e,t)=>{t.stack.body||t.stack.detail?(console.log(t),(0,i.Am)({title:"Erreur lors de la modification du quota",description:t.stack.body||t.stack.detail,variant:"destructive"})):(o(),l(),(0,i.Am)({title:"Quota modifi\xe9",description:"Le quota a \xe9t\xe9 modifi\xe9 avec succ\xe8s."}))}}),isDeleteLoading:g,deleteQuota:(e,s)=>f({headers:{Authorization:"Bearer ".concat(a)},pathParams:{sportId:t,schoolId:e}},{onSettled:(e,t)=>{t.stack.body||t.stack.detail?(console.log(t),(0,i.Am)({title:"Erreur lors de la suppression du quota",description:t.stack.body||t.stack.detail,variant:"destructive"})):(o(),s(),(0,i.Am)({title:"Quota supprim\xe9",description:"Le quota a \xe9t\xe9 supprim\xe9 avec succ\xe8s."}))}})}}}},function(e){e.O(0,[8310,1414,9522,411,278,8068,9859,5763,5184,1312,584,2008,6777,8175,4032,769,2971,2117,1744],function(){return e(e.s=88381)}),_N_E=e.O()}]);