(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1177],{27358:function(e,t,a){Promise.resolve().then(a.bind(a,77308))},77308:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return x}});var n=a(57437),i=a(2265),s=a(90163),o=a(74291),l=a(12381);function r(e){let{isOpen:t,onClose:a,onConfirm:i,locationName:s,isLoading:r=!1}=e;return(0,n.jsx)(o.Vq,{open:t,onOpenChange:a,children:(0,n.jsxs)(o.cZ,{children:[(0,n.jsxs)(o.fK,{children:[(0,n.jsx)(o.$N,{children:"Supprimer le lieu"}),(0,n.jsxs)(o.Be,{children:['\xcates-vous s\xfbr de vouloir supprimer le lieu "',s,'" ? Cette action ne peut pas \xeatre annul\xe9e.']})]}),(0,n.jsxs)(o.cN,{children:[(0,n.jsx)(l.z,{variant:"outline",onClick:a,disabled:r,children:"Annuler"}),(0,n.jsx)(l.z,{variant:"destructive",onClick:i,disabled:r,children:r?"Suppression...":"Supprimer"})]})]})})}let d=(0,a(30166).default)(()=>Promise.all([a.e(5641),a.e(8104)]).then(a.bind(a,28104)),{loadableGenerated:{webpack:()=>[28104]},ssr:!1,loading:()=>(0,n.jsx)("div",{className:"h-64 w-full rounded-md border border-input bg-muted flex items-center justify-center",children:(0,n.jsx)("div",{className:"text-muted-foreground",children:"Chargement de la carte..."})})});function c(e){let{onCoordinatesChange:t,onLocationEdit:a,locations:i=[],className:s="",form:o,onSubmit:l,onCancel:r,isCreating:c=!1,editingLocation:u,isCreateLoading:m=!1,isUpdateLoading:f=!1,isDeleteLoading:p=!1,onDelete:x}=e;return(0,n.jsx)("div",{className:s,children:(0,n.jsx)(d,{onCoordinatesChange:(e,a,n)=>{t(e,a,n)},onLocationEdit:a,locations:i,form:o,onSubmit:l,onCancel:r,isCreating:c,editingLocation:u,isCreateLoading:m,isUpdateLoading:f,isDeleteLoading:p,onDelete:x})})}var u=a(29501),m=a(13590),f=a(91115);let p=f.z.object({name:f.z.string().min(1,"Le nom est requis"),description:f.z.string().optional(),address:f.z.string().optional(),latitude:f.z.number().optional(),longitude:f.z.number().optional()});function x(){var e;let{locations:t,createLocation:a,updateLocation:o,deleteLocation:l,isLoading:d,isCreateLoading:f,isUpdateLoading:x,isDeleteLoading:g}=(0,s.Z)(),[h,v]=(0,i.useState)(null),[b,j]=(0,i.useState)(!1),[N,y]=(0,i.useState)({isOpen:!1,location:null}),k=(0,u.cI)({resolver:(0,m.F)(p),defaultValues:{name:"",description:"",address:"",latitude:void 0,longitude:void 0}});return d?(0,n.jsxs)("div",{className:"container mx-auto p-6",children:[(0,n.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,n.jsx)("h1",{className:"text-3xl font-bold",children:"Gestion des lieux"})}),(0,n.jsx)("div",{className:"text-center",children:"Chargement..."})]}):(0,n.jsxs)("div",{className:"container mx-auto p-6",children:[(0,n.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,n.jsx)("h1",{className:"text-3xl font-bold",children:"Gestion des lieux"})}),(0,n.jsx)("div",{className:"w-full",children:(0,n.jsx)(c,{onCoordinatesChange:(e,t,a)=>{h||(j(!0),k.reset({name:"",description:"",address:a,latitude:e,longitude:t}))},locations:t,onLocationEdit:e=>{j(!1),v(e),k.reset({name:e.name||"",description:e.description||"",address:e.address||"",latitude:e.latitude||void 0,longitude:e.longitude||void 0})},form:k,onSubmit:e=>{h?o(h.id,e,()=>{v(null),k.reset()}):a(e,()=>{j(!1),k.reset()})},onCancel:()=>{b&&j(!1),h&&v(null),k.reset()},isCreating:b,editingLocation:h,isCreateLoading:f,isUpdateLoading:x,isDeleteLoading:g,onDelete:e=>{let a=null==t?void 0:t.find(t=>t.id===e);a&&y({isOpen:!0,location:a})},className:"h-[calc(100vh-15rem)]"})}),(0,n.jsx)(r,{isOpen:N.isOpen,onClose:()=>{y({isOpen:!1,location:null})},onConfirm:()=>{N.location&&l(N.location.id,()=>{var e;y({isOpen:!1,location:null}),(null==h?void 0:h.id)===(null===(e=N.location)||void 0===e?void 0:e.id)&&(v(null),k.reset())})},locationName:(null===(e=N.location)||void 0===e?void 0:e.name)||"",isLoading:g})]})}},74291:function(e,t,a){"use strict";a.d(t,{$N:function(){return x},Be:function(){return g},Vq:function(){return r},cN:function(){return p},cZ:function(){return m},fK:function(){return f},hg:function(){return d}});var n=a(57437),i=a(2265),s=a(49027),o=a(32489),l=a(94508);let r=s.fC,d=s.xz,c=s.h_;s.x8;let u=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,n.jsx)(s.aV,{ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...i})});u.displayName=s.aV.displayName;let m=i.forwardRef((e,t)=>{let{className:a,children:i,hideClose:r,...d}=e;return(0,n.jsxs)(c,{children:[(0,n.jsx)(u,{}),(0,n.jsxs)(s.VY,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...d,children:[i,!r&&(0,n.jsxs)(s.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,n.jsx)(o.Z,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=s.VY.displayName;let f=e=>{let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};f.displayName="DialogHeader";let p=e=>{let{className:t,...a}=e;return(0,n.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};p.displayName="DialogFooter";let x=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,n.jsx)(s.Dx,{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",a),...i})});x.displayName=s.Dx.displayName;let g=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,n.jsx)(s.dk,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",a),...i})});g.displayName=s.dk.displayName},90163:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var n=a(41494),i=a(25779),s=a(28207),o=a(18752);let l=()=>{let{token:e,isTokenExpired:t}=(0,s.a)(),{isAdmin:a}=(0,i.a)(),{data:l,isLoading:r,refetch:d,error:c}=(0,n.MbP)({headers:{Authorization:"Bearer ".concat(e)}},{enabled:a()&&!t(),retry:0,queryHash:"getLocations"}),{mutate:u,isPending:m}=(0,n.v_A)(),{mutate:f,isPending:p}=(0,n.q18)(),{mutate:x,isPending:g}=(0,n.Bjw)();return{locations:l,createLocation:(t,a)=>u({headers:{Authorization:"Bearer ".concat(e)},body:t},{onSettled:(e,t)=>{t.stack.body||t.stack.detail?(console.log(t),(0,o.Am)({title:"Erreur lors de l'ajout du lieu",description:t.stack.body||t.stack.detail,variant:"destructive"})):(d(),a(),(0,o.Am)({title:"Lieu ajout\xe9",description:"Le lieu a \xe9t\xe9 ajout\xe9 avec succ\xe8s."}))}}),updateLocation:(t,a,n)=>f({headers:{Authorization:"Bearer ".concat(e)},body:a,pathParams:{locationId:t}},{onSettled:(e,t)=>{t.stack.body||t.stack.detail?(console.log(t),(0,o.Am)({title:"Erreur lors de la modification du lieu",description:t.stack.body||t.stack.detail,variant:"destructive"})):(d(),n(),(0,o.Am)({title:"Lieu modifi\xe9",description:"Le lieu a \xe9t\xe9 modifi\xe9 avec succ\xe8s."}))}}),deleteLocation:(t,a)=>x({headers:{Authorization:"Bearer ".concat(e)},pathParams:{locationId:t}},{onSettled:(e,t)=>{t.stack.body||t.stack.detail?(console.log(t),(0,o.Am)({title:"Erreur lors de la suppression du lieu",description:t.stack.body||t.stack.detail,variant:"destructive"})):(d(),a(),(0,o.Am)({title:"Lieu supprim\xe9",description:"Le lieu a \xe9t\xe9 supprim\xe9 avec succ\xe8s."}))}}),error:c,isLoading:r,isCreateLoading:m,isUpdateLoading:p,isDeleteLoading:g,refetchLocations:d}}}},function(e){e.O(0,[1414,9522,411,278,558,8149,8175,2971,2117,1744],function(){return e(e.s=27358)}),_N_E=e.O()}]);