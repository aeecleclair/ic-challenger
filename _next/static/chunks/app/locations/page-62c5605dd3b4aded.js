(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2462],{36406:function(e,t,s){Promise.resolve().then(s.bind(s,68383))},68383:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var a=s(57437),n=s(2265),r=s(34040);s(35046);var l=s(83774),i=s(69174),o=s(12381);function c(e){var t,s,r,c;let{location:d,hasMatches:u,totalMatches:m,nextMatch:x,sports:h,schools:f}=e,[p,v]=n.useState(!1),g=n.useRef(null);return n.useEffect(()=>{if(p)return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)};function e(e){g.current&&!g.current.contains(e.target)&&v(!1)}},[p]),(0,a.jsxs)("div",{ref:g,className:"relative flex flex-col items-center select-none",style:{minWidth:60},children:[p&&(0,a.jsxs)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 z-10",children:[(0,a.jsx)("div",{className:"absolute left-1/2 top-full transform -translate-x-1/2",children:(0,a.jsx)("div",{className:"w-0 h-0 border-l-[12px] border-r-[12px] border-t-[12px] border-l-transparent border-r-transparent border-t-white drop-shadow-sm"})}),(0,a.jsxs)("div",{className:"w-[300px] sm:w-[350px] bg-white rounded-lg shadow-lg p-4 border",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"bg-rose-500/10 p-2 rounded-full shrink-0",children:(0,a.jsx)(l.Z,{className:"h-6 w-6 text-rose-500"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[(0,a.jsx)("h3",{className:"font-medium text-base truncate",children:d.name}),u&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(i.C,{variant:"outline",className:"border-green-500 text-green-600 text-xs",children:"Actif"}),(0,a.jsxs)(i.C,{variant:"destructive",className:"text-xs px-2",children:[m," match",1!==m?"s":""]})]})]}),d.description&&(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:d.description}),d.address&&(0,a.jsxs)("p",{className:"text-sm text-muted-foreground truncate mt-1",children:[(0,a.jsx)(l.Z,{className:"h-3 w-3 inline mr-1 opacity-70"}),d.address]})]})]}),x&&(0,a.jsxs)("div",{className:"bg-muted rounded p-2 mt-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsx)("div",{className:"font-semibold text-xs",children:"Prochain match"}),x.date&&(0,a.jsxs)(i.C,{variant:"default",className:"text-xs font-mono",children:[(0,a.jsx)(l.Z,{className:"h-3 w-3 mr-1"}),(()=>{let e=new Date,t=Math.round((new Date(x.date).getTime()-e.getTime())/6e4);if(t<0)return"Pass\xe9";if(t<60)return"".concat(t,"min");let s=Math.floor(t/60),a=t%60;return 0===a?"".concat(s,"h"):"".concat(s,"h").concat(a.toString().padStart(2,"0"))})()]})]}),(0,a.jsx)("div",{className:"flex items-center gap-2 flex-wrap mb-2",children:(null==x?void 0:x.sport_id)&&Array.isArray(h)&&(()=>{let e=h.find(e=>e.id===x.sport_id);return e?(0,a.jsx)(i.C,{variant:"outline",className:"text-xs flex items-center gap-1 bg-blue-50 border-blue-200 text-blue-700 hover:bg-blue-100",children:e.name}):null})()}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm font-medium",children:[(null==x?void 0:x.team1)&&(0,a.jsx)("span",{className:"transition-colors text-primary font-semibold",children:x.team1.name}),(0,a.jsx)("span",{className:"text-muted-foreground font-medium",children:"vs"}),(null==x?void 0:x.team2)&&(0,a.jsx)("span",{className:"transition-colors text-primary font-semibold",children:x.team2.name})]}),x.date&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-1",children:[(0,a.jsx)(l.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:new Date(x.date).toLocaleDateString("fr-FR",{day:"2-digit",month:"short",year:"numeric"})}),(0,a.jsx)(l.Z,{className:"h-3 w-3 ml-2"}),(0,a.jsx)("span",{children:new Date(x.date).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})]}),x.location&&(0,a.jsxs)(o.z,{variant:"ghost",size:"sm",onClick:()=>{var e,t,s;let a=x.location,n=(null==a?void 0:a.address)?"".concat(null!==(e=null==a?void 0:a.name)&&void 0!==e?e:"",", ").concat(null!==(t=null==a?void 0:a.address)&&void 0!==t?t:""):null!==(s=null==a?void 0:a.name)&&void 0!==s?s:"";window.open("https://www.google.com/maps/search/?api=1&query=".concat(encodeURIComponent(n)),"_blank")},className:"flex items-center gap-2 text-xs text-muted-foreground bg-slate-50 hover:bg-slate-100 p-2 rounded-lg transition-colors w-full justify-start h-auto mt-2",children:[(0,a.jsx)(l.Z,{className:"h-4 w-4"}),(0,a.jsxs)("div",{className:"flex flex-col items-start gap-1",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:null!==(r=null===(t=x.location)||void 0===t?void 0:t.name)&&void 0!==r?r:""}),(null===(s=x.location)||void 0===s?void 0:s.address)&&(0,a.jsx)("span",{className:"text-xs text-gray-500",children:x.location.address})]}),(0,a.jsx)("div",{className:"ml-auto flex items-center gap-1",children:(0,a.jsx)("span",{className:"text-xs font-medium",children:"Naviguer"})})]})]})]}),(0,a.jsx)("div",{className:"flex gap-2 mt-2",children:(0,a.jsxs)(o.z,{variant:"ghost",size:"sm",onClick:()=>{var e,t,s;let a=(null==d?void 0:d.address)?"".concat(null!==(e=null==d?void 0:d.name)&&void 0!==e?e:"",", ").concat(null!==(t=null==d?void 0:d.address)&&void 0!==t?t:""):null!==(s=null==d?void 0:d.name)&&void 0!==s?s:"";window.open("https://www.google.com/maps/search/?api=1&query=".concat(encodeURIComponent(a)),"_blank")},className:"flex items-center gap-2 text-xs text-muted-foreground bg-slate-50 hover:bg-slate-100 p-2 rounded-lg transition-colors w-full justify-start h-auto",children:[(0,a.jsx)(l.Z,{className:"h-4 w-4"}),(0,a.jsxs)("div",{className:"flex flex-col items-start gap-1",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700",children:null!==(c=null==d?void 0:d.name)&&void 0!==c?c:""}),(null==d?void 0:d.address)&&(0,a.jsx)("span",{className:"text-xs text-gray-500",children:d.address})]}),(0,a.jsx)("div",{className:"ml-auto flex items-center gap-1",children:(0,a.jsx)("span",{className:"text-xs font-medium",children:"Naviguer"})})]})})]}),(0,a.jsxs)("div",{className:"cursor-pointer",style:{position:"absolute",left:"50%",bottom:0,transform:"translateX(-50%)",zIndex:3},onClick:()=>v(e=>!e),children:[(0,a.jsx)(l.Z,{className:"w-8 h-8 ".concat(u?"text-rose-500":"text-gray-700"," drop-shadow-lg"),fill:"currentColor",style:{filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.3))"}}),u&&(0,a.jsx)(i.C,{variant:"destructive",className:"absolute -top-1 -right-1 min-w-[18px] h-4 flex items-center justify-center text-xs px-1",children:m})]})]})}function d(e){let{locations:t,locationsWithMatches:l,sports:i,schools:o,className:d="h-[calc(100vh-15rem)] w-full"}=e,u=(0,n.useRef)(null),m=(0,n.useRef)(null),x=(0,n.useRef)([]),h=(0,n.useCallback)((e,t,s,n,l)=>{if(!t.latitude||!t.longitude)return null;let i=(null==s?void 0:s.totalMatches)>0,o=document.createElement("div");o.className="location-marker-container",o.style.zIndex="1000",o.style.position="relative";let d=(0,r.createRoot)(o);d.render((0,a.jsx)(c,{location:t,hasMatches:i,totalMatches:(null==s?void 0:s.totalMatches)||0,nextMatch:null==s?void 0:s.nextMatch,sports:n,schools:l}));let u=e.divIcon({html:o,className:"custom-location-marker",iconSize:[32,40],iconAnchor:[32,0]}),m=e.marker([t.latitude,t.longitude],{icon:u});return m.on("click",t=>{e.DomEvent.stopPropagation(t)}),m._reactRoot=d,m},[]),f=e=>{if(e&&e._reactRoot){let t=e._reactRoot;setTimeout(()=>{try{t.unmount()}catch(e){console.warn("Error unmounting marker root:",e)}},0)}m.current&&e&&m.current.removeLayer(e)};return(0,n.useEffect)(()=>{if(!u.current||m.current)return;let e=u.current;return(async()=>{let a=await s.e(4212).then(s.t.bind(s,60759,23));if(e._leaflet_id){console.warn("Map container already has a Leaflet instance, skipping initialization");return}if(m.current=a.map(e).setView([45.782871,4.769279],12),a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(m.current),t.length>0){let e=t.filter(e=>e.latitude&&e.longitude);if(e.length>0){let t=new a.featureGroup;e.forEach(e=>{let s=l.find(t=>t.id===e.id),n=h(a,e,s,i,o);n&&n.addTo(t)}),m.current.fitBounds(t.getBounds().pad(.1))}}})().catch(console.error),()=>{m.current&&(x.current.forEach(f),m.current.remove(),m.current=null,x.current=[],m.current=null),u.current&&(u.current.innerHTML="",delete u.current._leaflet_id)}},[]),(0,n.useEffect)(()=>{m.current&&t&&(async()=>{if(await new Promise(e=>setTimeout(e,50)),!m.current)return;let e=await s.e(4212).then(s.t.bind(s,60759,23));x.current.forEach(f),x.current=[],t.forEach(t=>{if(t.latitude&&t.longitude){let s=l.find(e=>e.id===t.id),a=h(e,t,s,i,o);a&&m.current&&(a.addTo(m.current),x.current.push(a))}})})().catch(console.error)},[t,l,i,o,h]),(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsx)("div",{ref:u,className:"rounded-lg border shadow-sm ".concat(d),style:{minHeight:"400px"}})})}var u=s(90163),m=s(99914),x=s(67740),h=s(27875),f=s(76715),p=s(53517),v=s(48810);function g(){let{locations:e,isLoading:t}=(0,u.Z)(),{meParticipant:s}=(0,x.a)(),{sportMatches:r}=(0,m.k)({sportId:null==s?void 0:s.sport_id}),{sports:l}=(0,h.V)(),{filteredSchools:i}=(0,f.A)(),o=(0,n.useMemo)(()=>{if(!e||!r)return[];let t=new Date;return e.map(e=>{let s=r.filter(s=>s.location_id===e.id&&s.date&&new Date(s.date)>t).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime())[0],a=r.filter(t=>t.location_id===e.id).length;return{...e,nextMatch:s,totalMatches:a}})},[e,r]);return(0,a.jsxs)(p.Hn,{children:[(0,a.jsx)(v.S,{}),(0,a.jsxs)(p.kV,{children:[(0,a.jsx)("header",{className:"flex h-16 shrink-0 items-center gap-2",children:(0,a.jsx)("div",{className:"flex items-center gap-2 px-4",children:(0,a.jsx)(p.vP,{className:"-ml-1"})})}),(0,a.jsx)("div",{className:"flex flex-col relative overflow-auto h-full m-6",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Lieux de Comp\xe9tition"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"D\xe9couvrez tous les lieux o\xf9 se d\xe9roulent les matchs avec acc\xe8s direct aux cartes"})]})}),(0,a.jsx)(d,{locations:e||[],locationsWithMatches:o,sports:l,schools:i,className:"h-[700px] w-full"})]})})]})]})}},35046:function(){},95098:function(e,t,s){"use strict";s.d(t,{C2:function(){return l},TX:function(){return i},fC:function(){return o}});var a=s(2265),n=s(66840),r=s(57437),l=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),i=a.forwardRef((e,t)=>(0,r.jsx)(n.WV.span,{...e,ref:t,style:{...l,...e.style}}));i.displayName="VisuallyHidden";var o=i}},function(e){e.O(0,[5641,1414,9522,411,278,8068,9859,5184,1312,4278,8175,4430,3448,2971,2117,1744],function(){return e(e.s=36406)}),_N_E=e.O()}]);